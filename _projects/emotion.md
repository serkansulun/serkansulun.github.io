---
layout: page
title: Emotion-based Symbolic Music Generation
# description: with background image
img: assets/img/proj/midi.png
importance: 2
category: work
related_publications: true
permalink: /midi
---

While there are many symbolic music (MIDI) generators available, very few of them can be conditioned on high-level features such as emotions. Existing emotion-labeled MIDI datasets are limited, containing only a few thousand samples.

In this project, I first created an emotion-based MIDI dataset that is two orders of magnitude larger than the existing ones. The emotion labels are continuous valence-arousal values, enabling fine-grained conditioning. Then, I built multiple architectures for emotion-based symbolic music generation. To the best of my knowledge, this is the only transformer-based generator that can use continuous-valued conditions while processing discrete tokens.

The paper is available on [ArXiv](https://arxiv.org/abs/2203.16165) {% cite music %}. The source code is available on [Github](https://github.com/serkansulun/midi-emotion). Below, I present some output samples.

# Supplementary material

## Constant conditioning

In the table below, the left, middle, and right columns contain samples generated with negative (unpleasant), neutral and positive (pleasant) valence condition values, respectively. Similarly, the top, middle, and bottom rows contain samples generated with positive (excited), neutral, and negative (calm) arousal condition values, respectively. In each cell, we present samples generated by our three different models, named _discrete-token_ (DT), _continuous-token_ (CT), and _continuous-concatenated_ (CC). Note that all samples are the first random samples that are generated using each configuration, and hence, are not cherry-picked.

<style>
table, th, td {
  padding-top:20px;
  padding-bottom:15px;
  text-align: center;
  vertical-align: middle;
  border: 1px solid black;
  border-collapse: collapse;
}

.dbox {
    position: relative;
    width: 140px;
    height: 50px;
    border: 1px solid black;
}
/* add diagonal line */
.dbox:after {
    content: '';
    display: block;
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    margin: auto;
    z-index: -1;
    background: linear-gradient(to top right, transparent calc(50% - 1px), black, transparent calc(50% + 1px)  );

}
/* align boxes with headings */
.dheading_tr,
.dheading_bl{
    position: absolute;
    /* or wider if needed/possible */
    width: 50%; 
    height: 50%;
    overflow: hidden;
    /* background-color: rgba(255, 255, 0, 0.2); */
} 
.dheading_tr {  
    top: 0;
    right: 0;
    display: flex;
    justify-content: flex-end;
    align-items: flex-start;
}
.dheading_bl {
    bottom: 0;
    left: 0;
    display: flex;
    justify-content: flex-start;
    align-items: flex-end;
}

</style>

<br>

<table style="width:90%">
  <tr>
    <th class="dbox">
      <div class="dheading_tr"><b>Valence</b></div>
      <div class="dheading_bl"><b>Arousal</b></div>
    </th>
    <th>Negative</th>
    <th>Neutral</th>
    <th>Positive</th>
  </tr>
  <tr>
  <tr>
    <td>Positive</td>
    <td> 
    <!-- negative positive -->
      DT: 
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/discrete_token/0_V-2_A2.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
      <br>
      CT:
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/continuous_token/0_V-08_A08.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
      <br>
      CC:
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/continuous_concat/0_V-08_A08.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
    </td>
    <td>
    <!-- neutral positive -->
      DT: 
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/discrete_token/0_V0_A2.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
      <br>
      CT:
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/continuous_token/0_V00_A08.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
      <br>
      CC:
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/continuous_concat/0_V00_A08.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
    </td>
    <td> 
    <!-- positive positive -->
      DT: 
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/discrete_token/0_V2_A2.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
      <br>
      CT:
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/continuous_token/0_V08_A08.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
      <br>
      CC:
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/continuous_concat/0_V08_A08.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
    </td>
  </tr>
  <tr>
    <td>Neutral</td>
    <td> 
    <!-- negative neutral -->
      DT: 
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/discrete_token/0_V-2_A0.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
      <br>
      CT:
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/continuous_token/0_V-08_A00.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
      <br>
      CC:
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/continuous_concat/0_V-08_A00.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
    </td>
    <td>
    <!-- neutral neutral -->
      DT: 
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/discrete_token/0_V0_A0.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
      <br>
      CT:
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/continuous_token/0_V00_A00.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
      <br>
      CC:
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/continuous_concat/0_V00_A00.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
    </td>
    <td>
    <!-- positive neutral -->
      DT: 
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/discrete_token/0_V2_A0.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
      <br>
      CT:
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/continuous_token/0_V08_A00.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
      <br>
      CC:
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/continuous_concat/0_V08_A00.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
    </td>
  </tr>
  <td>Negative</td>
    <td> 
    <!-- negative negative -->
      DT: 
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/discrete_token/0_V-2_A-2.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
      <br>
      CT:
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/continuous_token/0_V-08_A-08.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
      <br>
      CC:
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/continuous_concat/0_V-08_A-08.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
    </td>
    <td>
    <!-- neutral negative -->
      DT: 
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/discrete_token/0_V0_A-2.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
      <br>
      CT:
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/continuous_token/0_V00_A-08.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
      <br>
      CC:
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/continuous_concat/0_V00_A-08.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
    </td>
    <td> 
    <!-- positive negative -->
      DT: 
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/discrete_token/0_V2_A-2.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
      <br>
      CT:
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/continuous_token/0_V08_A-08.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
      <br>
      CC:
      <audio controls preload="none">
        <source src="{{ '/assets/audio/midi/continuous_concat/0_V08_A-08.wav' | relative_url }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
    </td>
  </tr>

</table>

<br>

## Dynamic conditioning

I also present samples that are generated using dynamic conditioning, where the condition values change over time. I used the continuous-token (CC) and continuous-concatenated (CC) models since only they allow dynamic conditioning. Contrary to the samples previously presented, these samples _are_ cherry-picked.
<br>

#### Increasing valence, increasing arousal

<p>CT: &nbsp; &nbsp;
<audio controls preload="none">
  <source src="{{ '/assets/audio/midi/smooth_change/continuous_token/V-08_08_A-08_08.wav' | relative_url }}" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>
</p>

<p>CC: &nbsp; &nbsp;
<audio controls preload="none">
  <source src="{{ '/assets/audio/midi/smooth_change/continuous_concat/V-08_08_A-08_08.wav' | relative_url }}" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>
</p>

#### Decreasing valence, decreasing arousal

<p>CT: &nbsp; &nbsp;
<audio controls preload="none">
  <source src="{{ '/assets/audio/midi/smooth_change/continuous_token/V08_-08_A08_-08.wav' | relative_url }}" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>
</p>

<p>CC: &nbsp; &nbsp;
<audio controls preload="none">
  <source src="{{ '/assets/audio/midi/smooth_change/continuous_concat/V08_-08_A08_-08.wav' | relative_url }}" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>
</p>

#### Increasing valence, decreasing arousal

<p>CT: &nbsp; &nbsp;
<audio controls preload="none">
  <source src="{{ '/assets/audio/midi/smooth_change/continuous_token/V-08_08_A08_-08.wav' | relative_url }}" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>
</p>

<p>CC: &nbsp; &nbsp;
<audio controls preload="none">
  <source src="{{ '/assets/audio/midi/smooth_change/continuous_concat/V-08_08_A08_-08.wav' | relative_url }}" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>
</p>

#### Decreasing valence, increasing arousal

<p>CT: &nbsp; &nbsp;
<audio controls preload="none">
  <source src="{{ '/assets/audio/midi/smooth_change/continuous_token/V08_-08_A-08_08.wav' | relative_url }}" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>
</p>

<p>CC: &nbsp; &nbsp;
<audio controls preload="none">
  <source src="{{ '/assets/audio/midi/smooth_change/continuous_concat/V08_-08_A-08_08.wav' | relative_url }}" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>
</p>

<br>

# Cherry-picked samples

Here I present the cherry-picked samples generated for four basic emotions; happy, relaxed, sad and angry. \
These emotions occupy the four quadrants of the valence-arousal plane as shown below:

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
![Emotions](/assets/img/proj/valence_arousal.jpg)

<table style="width:60%">

<tr>

  <th>
  <b>ANGRY</b>
  <br>DT: 
  <audio controls preload="none">
      <source src="{{ '/assets/audio/midi/cherry/discrete_token/ANGRY.wav' | relative_url }}" type="audio/mpeg">
      Your browser does not support the audio element.
  </audio>
  <br>CT:
  <audio controls preload="none">
      <source src="{{ '/assets/audio/midi/cherry/continuous_token/ANGRY.wav' | relative_url }}" type="audio/mpeg">
      Your browser does not support the audio element.
  </audio>
  <br>CC:
  <audio controls preload="none">
      <source src="{{ '/assets/audio/midi/cherry/continuous_concat/ANGRY.wav' | relative_url }}" type="audio/mpeg">
      Your browser does not support the audio element.
  </audio>
  </th>

  <th>
  <b>HAPPY</b>
  <br>DT: 
  <audio controls preload="none">
      <source src="{{ '/assets/audio/midi/cherry/discrete_token/HAPPY.wav' | relative_url }}" type="audio/mpeg">
      Your browser does not support the audio element.
  </audio>
  <br>CT:
  <audio controls preload="none">
      <source src="{{ '/assets/audio/midi/cherry/continuous_token/HAPPY.wav' | relative_url }}" type="audio/mpeg">
      Your browser does not support the audio element.
  </audio>
  <br>CC:
  <audio controls preload="none">
      <source src="{{ '/assets/audio/midi/cherry/continuous_concat/HAPPY.wav' | relative_url }}" type="audio/mpeg">
      Your browser does not support the audio element.
  </audio>
  </th>

</tr>

<tr>

  <th>
  <b>SAD</b>
  <br>DT: 
  <audio controls preload="none">
      <source src="{{ '/assets/audio/midi/cherry/discrete_token/SAD.wav' | relative_url }}" type="audio/mpeg">
      Your browser does not support the audio element.
  </audio>
  <br>CT:
  <audio controls preload="none">
      <source src="{{ '/assets/audio/midi/cherry/continuous_token/SAD.wav' | relative_url }}" type="audio/mpeg">
      Your browser does not support the audio element.
  </audio>
  <br>CC:
  <audio controls preload="none">
      <source src="{{ '/assets/audio/midi/cherry/continuous_concat/SAD.wav' | relative_url }}" type="audio/mpeg">
      Your browser does not support the audio element.
  </audio>
  </th>

  <th>
  <b>RELAXED</b>
  <br>DT: 
  <audio controls preload="none">
      <source src="{{ '/assets/audio/midi/cherry/discrete_token/RELAXED.wav' | relative_url }}" type="audio/mpeg">
      Your browser does not support the audio element.
  </audio>
  <br>CT:
  <audio controls preload="none">
      <source src="{{ '/assets/audio/midi/cherry/continuous_token/RELAXED.wav' | relative_url }}" type="audio/mpeg">
      Your browser does not support the audio element.
  </audio>
  <br>CC:
  <audio controls preload="none">
      <source src="{{ '/assets/audio/midi/cherry/continuous_concat/RELAXED.wav' | relative_url }}" type="audio/mpeg">
      Your browser does not support the audio element.
  </audio>
  </th>

</tr>
</table>

<br><br><br>
Related lightning talk at [EPIA 2023](/emotion4midi):

<iframe width="900" height="510" src="https://www.youtube.com/embed/Q0oHmiiYtWk?si=zLSAVkBRZm98Axit" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
